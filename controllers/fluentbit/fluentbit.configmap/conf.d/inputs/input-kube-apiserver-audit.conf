{{- if .Values.Fluentbit.KubeApiserverAuditLogging }}
[INPUT]
    Name               tail
    Tag                audit.*
    Path               /var/log/kube-apiserver/audit.log
    Path_Key           tag
    Parser             json_apiserver_kube
    DB                 /var/log/kube-apiserver.db
    Mem_Buf_Limit      10M
    Skip_Long_Lines    On
    Skip_Empty_Lines   On
    Refresh_Interval   60
    storage.type       filesystem
    Buffer_Chunk_Size  64KB
    Buffer_Max_Size    3MB

{{- if .Values.OpenshiftDeploy }}
[INPUT]
    Name               tail
    Tag                audit.*
    Path               /var/log/openshift-apiserver/audit.log
    Path_Key           tag
    Parser             json_apiserver_kube
    DB                 /var/log/openshift-apiserver.db
    Mem_Buf_Limit      10M
    Skip_Long_Lines    On
    Skip_Empty_Lines   On
    Refresh_Interval   60
    storage.type       filesystem
    Buffer_Chunk_Size  64KB
    Buffer_Max_Size    3MB
{{- end }}
{{- end }}